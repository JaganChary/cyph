service firebase.storage {
	match /b/{bucket}/o {
		match /channels/{channel} {
			match /{all=**} {
				allow read, write;
			}

			// match /messages/{message} {}

			// match /users/{user} {}
		}

		match /fileTransfers/{file} {
			allow read;
			allow write: if request.resource == null || request.resource.size < 300000000;
		}

		match /users/{user} {
			match /{all=**} {
				allow read, write: if 
					request.auth != null &&
					(user + '@cyph.me') == request.auth.token.email
				;
			}

			match /avatar {
				allow read;
			}

			match /coverImage {
				allow read;
			}

			match /certificate {
				allow read;
				allow write: if false;
			}

			// match /contactRecords/{contactRecord} {}

			// match /contacts/{contact} {
			// 	match /messages/{message} {}
			// 	match /session {}
			// }

			// match /encryptionKeyPair {}

			// match /fileRecords/{fileRecord} {}

			// match /files/{file} {}

			// match /forms/{form} {}

			match /loginData {
				allow read;
			}

			match /presence {
				allow read;
			}

			match /publicProfile {
				allow read;
			}

			// match /settings {}

			// match /signingKeyPair {}
		}
	}
}
