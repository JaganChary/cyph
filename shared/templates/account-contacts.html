<div
	fxFlexFill
	fxLayout='row'
	class='card-list'
	[class.initiating]='accountContactsService.showSpinner'
>
	<div fxFlexFill fxLayout='column' fxLayoutAlign='start stretch'>
		<mat-form-field class='search-bar'>
			<input
				matInput
				cyphTranslate
				placeholder='Search'
				[formControl]='searchControl'
				[matAutocomplete]='autoComplete'
			/>
			<mat-progress-spinner
				matSuffix
				class='custom'
				diameter='20'
				strokeWidth='2'
				mode='indeterminate'
				*ngIf='searchSpinner'
			></mat-progress-spinner>
			<mat-icon
				matSuffix
				class='suffix-button'
				(click)='clearUserFilter()'
				*ngIf='!searchSpinner && (this.searchControl.value || userFilter)'
			>
				close
			</mat-icon>
		</mat-form-field>

		<mat-autocomplete
			#autoComplete='matAutocomplete'
			(optionSelected)='setUserFilter($event.option.value)'
		>
			<mat-option [value]='contact.username' *ngFor='let contact of searchOptions | async'>
				<img
					cyphTranslate
					aria-hidden
					[src]='contact.avatar | async'
					alt='User Avatar'
				/>
				<span>{{contact.name | async}}</span>
				<small>{{contact.realUsername | async}}</small>
			</mat-option>
		</mat-autocomplete>

		<cyph-account-contact
			class='active'
			[contact]='userFilter'
			*ngIf='!!userFilter'
		></cyph-account-contact>

		<cyph-account-contact
			class='active'
			[contact]='activeUser | async'
			*ngIf='!userFilter'
		></cyph-account-contact>

		<od-virtualscroll
			[vsData]='contactList'
			[vsEqualsFunc]='vsEqualsFunc'
			[vsOptions]='vsOptions'
			*ngIf='!userFilter && showContactList'
		>
			<ng-template let-item>
				<cyph-account-contact [contact]='item'></cyph-account-contact>
			</ng-template>
		</od-virtualscroll>
	</div>

	<mat-progress-spinner
		mode='indeterminate'
		*ngIf='accountContactsService.showSpinner'
	></mat-progress-spinner>
</div>
